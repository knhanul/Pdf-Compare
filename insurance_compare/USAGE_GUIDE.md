# 가입설계서 비교 프로그램 사용 가이드

## 빠른 시작

### Windows 사용자

1. Python 3.11 이상 설치 확인
   ```cmd
   python --version
   ```

2. 필수 패키지 설치
   ```cmd
   pip install PyQt6 pymupdf
   ```

3. 프로그램 실행
   ```cmd
   cd insurance_compare
   python insurance_compare_gui.py
   ```

### Mac/Linux 사용자

1. Python 3.11 이상 설치 확인
   ```bash
   python3 --version
   ```

2. 필수 패키지 설치
   ```bash
   pip3 install PyQt6 pymupdf
   ```

3. 실행 스크립트 사용
   ```bash
   cd insurance_compare
   ./run.sh
   ```

   또는 직접 실행
   ```bash
   python3 insurance_compare_gui.py
   ```

## 화면 구성

```
┌─────────────────────────────────────────────────────────────────┐
│ [템플릿 파일 열기] [생성본 파일 열기] [전체비교☑] [비교시작]  │
│                                    [◀이전차이점] [다음차이점▶]  │
├─────────────────────────────────────────────────────────────────┤
│ 상태: 파일을 선택하고 비교를 시작하세요.                        │
├──────────────────────────┬──────────────────────────────────────┤
│   템플릿 (원본)          │        생성본                        │
├──────────────────────────┼──────────────────────────────────────┤
│                          │                                      │
│   [PDF 뷰어 영역]        │      [PDF 뷰어 영역]                 │
│                          │                                      │
│   🔴 삭제된 내용         │      🟢 추가된 내용                  │
│   🟡 변경된 내용         │      🟡 변경된 내용                  │
│                          │                                      │
└──────────────────────────┴──────────────────────────────────────┘
```

## 단계별 사용법

### 1단계: 파일 로드

#### 템플릿 파일 열기
1. "템플릿 파일 열기 (원본)" 버튼 클릭
2. 원본 가입설계서 PDF 파일 선택
3. 왼쪽 뷰어에 PDF가 표시됨

#### 생성본 파일 열기
1. "생성본 파일 열기" 버튼 클릭
2. 비교할 가입설계서 PDF 파일 선택
3. 오른쪽 뷰어에 PDF가 표시됨

### 2단계: 비교 옵션 설정

#### 전체 비교 (기본)
- "전체 비교" 체크박스 선택 (기본값)
- 모든 섹션을 비교합니다

#### 섹션별 비교 (향후 지원)
- "전체 비교" 체크박스 해제
- 특정 섹션만 선택하여 비교
- *현재는 전체 비교만 지원됩니다*

### 3단계: 비교 시작

1. "비교 시작" 버튼 클릭
2. 진행 바가 표시되며 비교 진행
3. 비교 완료 시 결과 대화상자 표시
   - 총 차이점 개수
   - 변경/삭제/추가 개수
   - 색상 범례

### 4단계: 결과 확인

#### 색상 코딩
- 🟡 **노란색**: 내용이 변경됨
- 🔴 **빨간색**: 내용이 삭제됨 (템플릿에만 표시)
- 🟢 **초록색**: 내용이 추가됨 (생성본에만 표시)

#### 상세 정보 확인
1. 색상으로 표시된 영역에 마우스 커서를 올립니다
2. 툴팁이 표시되며 상세 변경 내용을 확인할 수 있습니다
   - 변경된 경우: 삭제된 단어와 추가된 단어 표시
   - 삭제된 경우: 삭제된 전체 텍스트 표시
   - 추가된 경우: 추가된 전체 텍스트 표시

#### 차이점 네비게이션
1. "다음 차이점 ▶" 버튼 클릭
   - 다음 차이점으로 자동 스크롤
   - 양쪽 뷰어가 동기화되어 이동
2. "◀ 이전 차이점" 버튼 클릭
   - 이전 차이점으로 이동
3. 상태 표시줄에 현재 차이점 번호 표시
   - 예: "차이점 5/127 - MODIFIED"

#### 스크롤 동기화
- 한쪽 뷰어를 스크롤하면 다른 쪽도 자동으로 동기화됩니다
- 매칭된 블록 기준으로 스크롤 위치가 조정됩니다

## 비교 결과 해석

### 변경됨 (MODIFIED) - 🟡 노란색
- 템플릿과 생성본 모두에 존재하지만 내용이 다른 경우
- 예시:
  - 템플릿: "○○○" → 생성본: "홍길동"
  - 템플릿: "××세" → 생성본: "41세"
  - 템플릿: "xxx" → 생성본: "2025년 8월 25일"

### 삭제됨 (DELETED) - 🔴 빨간색
- 템플릿에는 있지만 생성본에는 없는 경우
- 주로 불필요한 설명이나 플레이스홀더가 제거된 경우
- 예시:
  - "본 가입설계서는 페이지로 구성되어 있으며"
  - "ooo"

### 추가됨 (ADDED) - 🟢 초록색
- 생성본에만 있고 템플릿에는 없는 경우
- 새로운 정보나 상세 설명이 추가된 경우
- 예시:
  - "홍길동(남자, 41세)"
  - "2025년 8월 25일"

## 고급 기능

### 테스트 모드
비교 로직만 테스트하고 싶은 경우:

```bash
python test_comparison.py
```

출력 내용:
- PDF 파싱 결과
- 섹션 구조 분석
- 텍스트 블록 추출 정보
- 비교 결과 통계
- 차이점 샘플
- 하이라이트 정보

### 커스터마이징

#### 머릿글/바닥글 범위 조정
`pdf_parser.py` 파일의 상수 수정:

```python
class InsurancePDFParser:
    HEADER_Y_MAX = 85   # 머릿글 최대 Y좌표
    FOOTER_Y_MIN = 750  # 바닥글 최소 Y좌표
```

#### 유사도 임계값 조정
`text_comparator.py` 파일의 상수 수정:

```python
class TextComparator:
    SIMILARITY_THRESHOLD = 0.6  # 0.0 ~ 1.0 (낮을수록 더 많이 매칭)
```

#### 같은 라인 판정 범위 조정
`pdf_parser.py` 파일의 상수 수정:

```python
class InsurancePDFParser:
    SAME_LINE_THRESHOLD = 5  # Y좌표 차이 (픽셀)
```

## 문제 해결

### Q1: 프로그램이 실행되지 않습니다
**A**: 필수 패키지가 설치되어 있는지 확인하세요.

```bash
pip install PyQt6 pymupdf
```

### Q2: PDF 파일을 로드할 수 없습니다
**A**: 
- PDF 파일이 손상되지 않았는지 확인
- 파일 경로에 한글이나 특수문자가 있는지 확인
- 다른 프로그램에서 파일을 열고 있지 않은지 확인

### Q3: 비교 결과가 너무 많습니다
**A**: 
- 템플릿 파일에 플레이스홀더가 많으면 차이점이 많이 감지됩니다
- 이는 정상적인 동작입니다
- 중요한 변경사항을 찾기 위해 차이점 네비게이션을 사용하세요

### Q4: 일부 차이점이 감지되지 않습니다
**A**: 
- 유사도 임계값을 낮춰보세요 (0.6 → 0.5)
- 머릿글/바닥글 범위를 조정해보세요
- 같은 라인 판정 범위를 늘려보세요

### Q5: 프로그램이 느립니다
**A**: 
- 대용량 PDF 파일은 처리 시간이 오래 걸릴 수 있습니다
- 진행 바를 확인하여 진행 상황을 모니터링하세요
- 페이지 수가 많은 경우 수십 초가 소요될 수 있습니다

### Q6: GUI가 표시되지 않습니다 (Linux)
**A**: 
- X11 또는 Wayland 디스플레이 서버가 실행 중인지 확인
- 필요한 Qt 플랫폼 플러그인 설치:
  ```bash
  sudo apt-get install libxcb-cursor0
  ```

## 성능 최적화 팁

1. **대용량 파일 처리**
   - 페이지 수가 많은 경우 비교 시간이 오래 걸립니다
   - 가능하면 필요한 페이지만 추출하여 비교하세요

2. **메모리 사용**
   - 여러 파일을 연속으로 비교할 때는 프로그램을 재시작하세요
   - 메모리 누수를 방지할 수 있습니다

3. **화면 렌더링**
   - 고해상도 모니터에서는 렌더링이 느릴 수 있습니다
   - 필요시 스케일 값을 조정하세요 (기본값: 2.0)

## 추가 정보

### 지원하는 PDF 형식
- 텍스트 레이어가 있는 PDF
- 스캔된 이미지 PDF는 지원하지 않습니다 (OCR 필요)

### 한글 지원
- 한글 텍스트 완벽 지원
- 한글 파일명 지원

### 보안
- 로컬에서만 실행되며 외부로 데이터를 전송하지 않습니다
- 비밀번호로 보호된 PDF는 지원하지 않습니다

## 연락처

문제가 발생하거나 개선 사항이 있으면 이슈를 등록해주세요.
